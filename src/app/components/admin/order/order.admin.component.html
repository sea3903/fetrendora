<div class="order-admin-page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h2>Quản lý đơn hàng</h2>
    </div>
    <!-- Optional: Export button -->
  </div>

  <!-- Search Bar -->
  <div class="search-bar">
    <div class="search-input-wrapper">
      <i class="fas fa-search"></i>
      <input type="text" [(ngModel)]="keyword" placeholder="Tìm đơn hàng theo tên" (keyup.enter)="searchOrders()">
    </div>
    <button class="btn-search" (click)="searchOrders()">Tìm kiếm</button>
  </div>

  <!-- Table -->
  <div class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th class="col-id">Mã Đơn</th>
          <th class="col-customer">Khách Hàng</th>
          <th class="col-date">Ngày Đặt</th>
          <th class="col-status text-center">Trạng Thái</th>
          <th class="col-total text-end">Tổng Tiền</th>
          <th class="col-actions text-center">Thao tác</th>
        </tr>
      </thead>
      <tbody>
        @for(order of orders; track order.id){
        <tr>
          <td class="col-id main-text">#{{ order.id }}</td>
          <td class="col-customer">
            <div class="customer-name">{{ order.fullname }}</div>
            <div class="customer-phone">{{ order.phone_number }}</div>
          </td>
          <td class="col-date">{{ order.order_date | date:'dd/MM/yyyy' }}</td>
          <td class="col-status text-center">
            <span class="badge-status" [ngClass]="order.status">
              {{ order.status == 'pending' ? 'Chờ xử lý' :
              order.status == 'processing' ? 'Đang xử lý' :
              order.status == 'shipped' ? 'Đang giao' :
              order.status == 'delivered' ? 'Đã giao' :
              order.status == 'cancelled' ? 'Đã hủy' : order.status }}
            </span>
          </td>
          <td class="col-total text-end main-text">{{ order.total_money | number }} đ</td>
          <td class="col-actions text-center">
            <div class="action-btns">
              <button class="btn-icon edit" (click)="viewDetails(order)" title="Xem chi tiết">
                <i class="fas fa-eye"></i>
              </button>
              @if(order.status !== 'cancelled' && order.status !== 'delivered') {
              <button class="btn-icon warning" (click)="cancelOrder(order.id)" title="Hủy đơn (Hoàn kho)">
                <i class="fas fa-ban"></i>
              </button>
              }
              <button class="btn-icon delete" (click)="deleteOrder(order.id)" title="Xóa đơn hàng">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
        }
        @if(orders.length === 0) {
        <tr>
          <td colspan="6" class="empty-state">
            <i class="fas fa-inbox"></i>
            <p>Không tìm thấy đơn hàng nào</p>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="pagination-container" *ngIf="totalPages > 1">
    <button class="page-btn" [disabled]="currentPage === 0" (click)="onPageChange(0)">
      <i class="fas fa-angle-double-left"></i>
    </button>
    <button class="page-btn" [disabled]="currentPage === 0" (click)="onPageChange(currentPage - 1)">
      <i class="fas fa-angle-left"></i>
    </button>

    <button *ngFor="let page of visiblePages" class="page-btn" [class.active]="page === currentPage + 1"
      (click)="onPageChange(page - 1)">
      {{ page }}
    </button>

    <button class="page-btn" [disabled]="currentPage >= totalPages - 1" (click)="onPageChange(currentPage + 1)">
      <i class="fas fa-angle-right"></i>
    </button>
    <button class="page-btn" [disabled]="currentPage >= totalPages - 1" (click)="onPageChange(totalPages - 1)">
      <i class="fas fa-angle-double-right"></i>
    </button>
  </div>
</div>